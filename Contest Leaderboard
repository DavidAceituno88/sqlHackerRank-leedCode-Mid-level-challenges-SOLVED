WITH CTE AS (
SELECT MAX(score) AS mscore, hacker_id, challenge_id
FROM Submissions 
GROUP BY hacker_id, challenge_id)
SELECT c.hacker_id,name,SUM(mscore)as total
FROM CTE C
JOIN Hackers h
ON c.hacker_id = h.hacker_id
GROUP BY c.hacker_id,name
HAVING SUM(mscore) <> 0
ORDER BY total DESC,c.hacker_id

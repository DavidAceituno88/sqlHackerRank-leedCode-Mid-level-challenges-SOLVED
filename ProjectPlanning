WITH CTE1 AS (
SELECT START_DATE , RANK() OVER(ORDER BY START_DATE) AS RANK_START_DATE
FROM PROJECTS 
WHERE START_DATE NOT IN (SELECT END_DATE FROM PROJECTS)),
    CTE2 AS(
    SELECT END_DATE, RANK() OVER(ORDER BY END_DATE) AS RANK_END_DATE
        FROM PROJECTS
        WHERE END_DATE NOT IN(SELECT START_DATE FROM PROJECTS))
SELECT START_DATE, END_DATE
        FROM CTE1, CTE2
        WHERE RANK_START_DATE = RANK_END_DATE
        ORDER BY DATEDIFF(day,start_date,end_date), start_date
